{"version":3,"file":"js/673.882291ca.js","mappings":"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","sources":["webpack://vue3-music/./src/views/home-view/components/Singer.vue","webpack://vue3-music/./src/views/home-view/components/Singer.vue?03ea"],"sourcesContent":["import { unref as _unref, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, resolveDirective as _resolveDirective, withDirectives as _withDirectives, withCtx as _withCtx, createVNode as _createVNode, withModifiers as _withModifiers, normalizeClass as _normalizeClass, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-3ca86b24\"), n = n(), _popScopeId(), n);\n\nconst _hoisted_1 = {\n  class: \"singer\"\n};\nconst _hoisted_2 = {\n  class: \"group\"\n};\nconst _hoisted_3 = [\"onClick\"];\nconst _hoisted_4 = {\n  class: \"avatar\"\n};\nconst _hoisted_5 = {\n  alt: \"头像\"\n};\nconst _hoisted_6 = {\n  class: \"index-bar\"\n};\nconst _hoisted_7 = [\"onTouchstart\", \"onTouchmove\", \"onTouchend\"];\nimport Scroll from \"@/components/Scroll.vue\";\nimport { reactive } from \"@vue/reactivity\";\nimport { getHotSinger, getSingerList } from \"@/api/song\";\nimport { nextTick, onMounted, ref, watch } from \"@vue/runtime-core\";\nimport { useRouter } from \"vue-router\"; // butterscroll实例对象\n\nexport default {\n  __name: 'Singer',\n\n  setup(__props) {\n    let scrollRef = ref(null); // 锚点\n\n    let gropRef = ref(null); //触摸点\n\n    let touchPosition = {}; // 激活的索引下标\n\n    let currentIndex = ref(0);\n    let moveIndex = 0;\n    let temArr = reactive([]);\n    let allGroupAllHeight = ref([]);\n    let router = useRouter();\n\n    function headleClick(id) {\n      router.push(`/m/SingerDetail/${id}`); // console.log(id)\n    } // 监听当前索引栏字母位置，触摸，触摸滚动,\n\n\n    function handleTouchMove(e, i) {\n      touchPosition.y2 = e.touches[0].pageY;\n      moveIndex = i + Math.floor((touchPosition.y2 - touchPosition.y1) / 20);\n      scrollTo(moveIndex);\n    }\n\n    function handleTouchStart(e, i) {\n      touchPosition.y1 = e.touches[0].pageY;\n      moveIndex = i;\n    }\n\n    function handelTouch(i) {\n      if (moveIndex == i) {\n        scrollTo(i);\n      }\n    } // 移动函数\n\n\n    function scrollTo(i) {\n      i = Math.max(0, Math.min(i, 26));\n      currentIndex.value = i;\n      let targetElement = gropRef.value.children[i];\n      let scroll = scrollRef.value.scroll;\n      scroll.scrollToElement(targetElement, 300);\n    }\n\n    watch(() => temArr.length, async () => {\n      await nextTick();\n      let allGroupLi = gropRef.value.children; // 初始高度\n\n      let initHeight = 0;\n      let temp = [initHeight];\n\n      for (let i = 0; i < allGroupLi.length; i++) {\n        temp.push(initHeight += allGroupLi[i].offsetHeight);\n      }\n\n      allGroupAllHeight.value = temp;\n    }); // 页面滚动，固定栏同步\n\n    function handleScrollView(y) {\n      y = -y;\n      allGroupAllHeight.value.forEach((itemY, i) => {\n        let nextItemY = allGroupAllHeight.value[i + 1];\n\n        if (y >= itemY && y < nextItemY) {\n          currentIndex.value = i;\n        }\n      });\n    }\n\n    let singerList = handleAnchor();\n\n    function handleAnchor() {\n      let arr = reactive([{\n        tag: \"热\"\n      }]);\n\n      for (let i = 65; i < 91; i++) {\n        arr.push({\n          tag: String.fromCharCode(i)\n        });\n      }\n\n      return arr;\n    }\n\n    onMounted(() => {\n      singerList.forEach(item => {\n        if (item.tag == \"热\") {\n          getHotSinger().then(res => {\n            item.singerInfo = res.data.artists;\n            temArr.push(item.singerInfo);\n          }).catch(err => {\n            console.log(\"请求热门歌手失败！\");\n          });\n        } else {\n          getSingerList(item.tag).then(res => {\n            item.singerInfo = res.data.artists;\n            temArr.push(item.singerInfo);\n          }).catch(err => {\n            console.log(\"请求\" + item.tag + \"歌手失败！\");\n          });\n        }\n      });\n    });\n    return (_ctx, _cache) => {\n      const _directive_loadingimg = _resolveDirective(\"loadingimg\");\n\n      return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createVNode(Scroll, {\n        class: \"scroll-plane\",\n        ref_key: \"scrollRef\",\n        ref: scrollRef,\n        probeType: 3,\n        onScroll: handleScrollView\n      }, {\n        default: _withCtx(() => [_createElementVNode(\"ul\", {\n          class: \"singer-list\",\n          ref_key: \"gropRef\",\n          ref: gropRef\n        }, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(singerList), item => {\n          return _openBlock(), _createElementBlock(\"li\", {\n            class: \"singer-list-group\",\n            key: item.tag\n          }, [_createElementVNode(\"p\", _hoisted_2, _toDisplayString(item.tag), 1), _createElementVNode(\"ul\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(item.singerInfo, sItem => {\n            return _openBlock(), _createElementBlock(\"li\", {\n              class: \"group-item\",\n              key: sItem.id,\n              onClick: $event => headleClick(sItem.id)\n            }, [_createElementVNode(\"div\", _hoisted_4, [_withDirectives(_createElementVNode(\"img\", _hoisted_5, null, 512), [[_directive_loadingimg, sItem.picUrl]])]), _createElementVNode(\"span\", null, _toDisplayString(sItem.name), 1)], 8, _hoisted_3);\n          }), 128))])]);\n        }), 128))], 512)]),\n        _: 1\n      }, 512), _createElementVNode(\"div\", _hoisted_6, [_createElementVNode(\"ul\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(singerList), (item, index) => {\n        return _openBlock(), _createElementBlock(\"li\", {\n          onTouchstart: _withModifiers($event => handleTouchStart($event, index), [\"prevent\", \"stop\"]),\n          class: _normalizeClass({\n            current: _unref(currentIndex) === index\n          }),\n          key: item.tag,\n          onTouchmove: _withModifiers($event => handleTouchMove($event, index), [\"prevent\", \"stop\"]),\n          onTouchend: _withModifiers($event => handelTouch(index), [\"prevent\", \"stop\"])\n        }, _toDisplayString(item.tag), 43, _hoisted_7);\n      }), 128))])])]);\n    };\n  }\n\n};","/* unplugin-vue-components disabled */import script from \"./Singer.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./Singer.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./Singer.vue?vue&type=style&index=0&id=3ca86b24&lang=less&scoped=true\"\n\nimport exportComponent from \"C:\\\\Users\\\\admin\\\\Downloads\\\\vue3-music\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-3ca86b24\"]])\n\nexport default __exports__"],"names":["_hoisted_1","class","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","alt","_hoisted_6","_hoisted_7","__name","setup","__props","scrollRef","gropRef","touchPosition","currentIndex","moveIndex","temArr","allGroupAllHeight","router","headleClick","id","push","handleTouchMove","e","i","y2","touches","pageY","Math","floor","y1","scrollTo","handleTouchStart","handelTouch","max","min","value","targetElement","children","scroll","scrollToElement","handleScrollView","y","forEach","itemY","nextItemY","length","async","allGroupLi","initHeight","temp","offsetHeight","singerList","handleAnchor","arr","tag","String","fromCharCode","item","then","res","singerInfo","data","artists","catch","err","console","log","_ctx","_cache","_directive_loadingimg","Scroll","ref_key","ref","probeType","onScroll","default","_","key","sItem","onClick","$event","picUrl","name","index","onTouchstart","current","onTouchmove","onTouchend","__exports__"],"sourceRoot":""}